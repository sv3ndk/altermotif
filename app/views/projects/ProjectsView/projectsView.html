#{extends 'masterTemplate.html' /} 

#{set 'moreStyles'}
    <link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/profile.css'}" />
	<link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/projects/projectsView.css'}" />
    <link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/nondab/colorbox/colorbox.css'}" />
#{/set} 

#{set 'moreScripts'}
	<script type="text/javascript"
		src="http://maps.google.com/maps/api/js?sensor=false"></script>

    <script src="@{'/public/javascripts/nondab/colorbox/jquery.colorbox.js'}" type="text/javascript"
    	charset="${_response_encoding}"></script>
	
	<script src="@{'/public/javascripts/dabGeocoder.js'}"
		type="text/javascript" charset="${_response_encoding}"></script>
	
	<script src="@{'/public/javascripts/language.js'}"
		type="text/javascript" charset="${_response_encoding}"></script>
	
	<script src="@{'/public/javascripts/projects/projectsView.js'}"
		type="text/javascript" charset="${_response_encoding}"></script>
	
	<script type="text/javascript">
	
	    var applytoProject = #{jsAction @projects.ProjectsView.doApplyToProject(':projectId', ':applicationText') /};
	    var cancelApplicationToProject = #{jsAction @projects.ProjectsView.doCancelApplyToProject(':projectId') /};
	    var rejectApplicationToProject = #{jsAction @projects.ProjectsView.doRejectApplicationToProject(':projectId', ':applicant') /};
	    
	    var isApplyLinkVisible = ${projectVisibility.isApplyLinkVisible()};
	    var isCancelApplicationLinkVisible = ${projectVisibility.isCancelApplicationLinkVisible()};
	    
	    var projectId = "${visitedProject.id}"; 
	
		$(document).ready(function() {
			init();
		})
	</script>
#{/set}


<!-- some hidden data, for javascript -->
<span id="allPossibleLanguageNames" class="hidden">${allPossibleLanguageNames}</span>

<div id="projectViewContainer" class="pageContainer">

	<p class="pageTitle">${visitedProject?.pdata?.name}</p>


	<div id="projectPhotoContainer">
		#{photoGallery
			mainPhoto:visitedProject.mainPhoto , 
			galleryType:'project',
			photos:visitedProject.photos,
			isPhotoGalleryVisible:projectVisibility.isPhotoGalleryVisible(),
			isProjectEditLinkVisible:projectVisibility.isEditPhotoGalleryLinkVisible(),
			visitedProjectId:visitedProject.id
		 /}
	</div>

	#{projects.viewProjectBasicDetails visitedProject:visitedProject, projectVisibility:projectVisibility/} 
	#{if projectVisibility.isToolBoxVisible() }
		<div id="projectToolBox">
			<ul>
				<li>#{if projectVisibility.isEditProjectLinkVisisble() } <a
					href="@{projects.ProjectsEdit.projectsEdit( visitedProject.id)}"
					class="dabLink">&{'projectViewEditProjet'}</a> #{/if}
				</li>
	
				<li>#{if projectVisibility.isCancelProjectLinkVisisble() } <span
					class="dabLinkDisabled">&{'projectViewCancelProjet'}</span> #{/if}
				</li>
	
				<li>#{if projectVisibility.isEndProjectLinkVisisble() } 
					<span class="dabLinkDisabled">&{'projectViewEndProjet'}</span> 
					#{/if}
				</li>
			</ul>
		</div>
	#{/if}


	<div id="projectBody">
		#{projects.viewProjectDescription visitedProject:visitedProject/}

		<div id="projectParticipants">
			<span class="toggleLink dabLink">&{'viewProjectParticipants'} (${visitedProject.numberOfConfirmedParticipants}) </span>
			<div class="toggleContainer">
				#{list items:visitedProject.confirmedParticipants, as:'participant'}
					#{projects.participant participant:participant /} 
				#{/list}
			</div>
		</div>
		
		#{if projectVisibility.isVisibleApplicationBox()}
		<div id="projectApplications">
			<span class="toggleLink dabLink">&{'viewProjectApplications'} (${visitedProject.numberOfApplications}) </span>
			<div class="toggleContainer">
				#{list items:visitedProject.unconfirmedParticipants, as:'application'}
					#{projects.application application:application /} 
				#{/list}
			</div>
		</div>
		#{/if}
		
		
	</div>

</div>


<div id="confirmApplyToProjectDialog" title="&{'confirmationPopupTitle'}">
	&{'viewProjectConfirmApply'}
	<br />
	<br />
	<textarea cols="45" rows="7"></textarea>
</div>

<div id="confirmCancelApplicationToProjectDialog" title="&{'confirmationPopupTitle'}">
	&{'viewProjectConfirmCancelApplication'}
</div>

<div id="applicationMotivationPopup" title="&{'applicationMoticationTextPopupTitle'}">
	<textarea readonly="readonly" rows="7" cols="45" ></textarea>
</div>

<div id="confirmRejectApplicationtDialog" title="&{'confirmationPopupTitle'}">
	&{'viewProjectConfirmRejectApplication'}
</div>
