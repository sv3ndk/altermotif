#{extends 'masterTemplate.html' /}

#{set 'moreScripts'}
    <script src="@{'/public/javascripts/projects/projectsResults.js'}" type="text/javascript" charset="${_response_encoding}"></script>
    
	<script type="text/javascript">
	    var originalSearchRequestJson = ${originalSearchRequestJson.raw()};
	    var defaultRefenceLocation = "${defaultRefenceLocation}";
	    var defaultReferenceLatitude = "${defaultReferenceLatitude}";
	    var defaultReferenceLongitude = "${defaultReferenceLongitude}";
	    
	</script>
    
#{/set}

#{set 'moreStyles'}
    <link rel="stylesheet" type="text/css" media="screen" href="@{'/public/stylesheets/projects/projectsResults.css'}" />
#{/set}

<div id="projectSearchResultContainer">
	<span id="searchResultTitle">&{'projectSearchResultTitle'}</span>
	<a href="@{projects.ProjectsSearch.projectsSearch()}" class="dabLink">&{'projectSearchResultBackToSearchPage'}</a>
	<br />

	<div id="projectResultRefineQueryContainer">
		<span id="projectResultFilterLink" class="dabLink">&{'projectSearchResultFilterResults'}...</span>
		<br />
		
		<span id="projectResultSortByLink" class="dabLink">&{'projectSearchResultSortBy'}...</span>
		<div id="projectResultSortByDetails" data-bind="visible: isSortByVisible">
			<ul>
				<li><label><input type="radio" value="alphabetic" data-bind="checked: sortKey"></input>&{'projectSearchResultSortByAlphabetic'}</label></li>
				<li><label><input type="radio" value="duedate" data-bind="checked: sortKey"></input>&{'projectSearchResultSortByDueDate'}</label></li>
				<li><label><input type="radio" value="proximity" data-bind="checked: sortKey"></input>&{'projectSearchResultSortByProximity'}: <span data-bind="text: refLocation"  ></span>
				<span class="dabLink" id="projectResultSortByProximityChangeRefLocationLink">(&{'projectResultChangeRefLocationLink'}...)</span>
				</label>
				<br />
				<div id="projectResultsSortInputLocation">
					#{dab.inputLocation /}
				</div>
				</li>
			</ul>
		</div>
		<div>
			<input id="projectResultUpdateResultButton" type="button" value="&{'projectSearchResultUpdateButtonText'}"></input>
		</div>
	</div>
	
	<div id="projectSearchResultList">
		#{list items:projectsOverviews, as:'oneOverview'}
			#{projectOverview overview:oneOverview /}
		#{/list}
	</div>
</div>

<div id="hiddenRefreshResultsForm" class="hidden">
	#{form @projects.ProjectsResults.projectsResults()}
		<input class="term" name="r.term" type="hidden">
		<input class="tag" name="r.tag" type="hidden">
		<input class="allThemesJson" name="r.themes" type="hidden" />
		<input class="sortkey" name="r.sortkey" type="hidden" /> 
		<input class="reflocation" name="rl.location" type="hidden" /> 
		<input class="reflatitude" name="rl.latitude" type="hidden" /> 
		<input class="reflongitude" name="rl.longitude" type="hidden" /> 
	#{/form }
</div>